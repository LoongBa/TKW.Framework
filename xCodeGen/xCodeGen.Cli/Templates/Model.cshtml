@using System.Linq
@using xCodeGen.Abstractions.Metadata
@using xCodeGen.Abstractions
@model xCodeGen.Abstractions.Metadata.ClassMetadata
@{
    var generatedNs = Model.GenerateCodeSettings["GeneratedNamespace"]?.ToString();
    string metaHash = Model.GenerateCodeSettings?.ContainsKey("MetadataHash") == true 
        ? Model.GenerateCodeSettings["MetadataHash"]?.ToString() : "N/A";
    var timestamp = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss");
}
// <auto-generated>
// 此文件由 xCodeGen 自动生成，请勿手动修改。
// @@[xCodeGen.Hash: @metaHash]
// 模型: @Model.ClassName (@Model.FullName)
// 生成时间: @timestamp
// </auto-generated>

using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using TKW.Framework.Domain.Interfaces;
using TKW.Framework.Common.Exceptions;
using xCodeGen.Abstractions;
using @generatedNs;

namespace @Model.Namespace;

public partial class @Model.ClassName : IDomainEntity
{
    public void Validate(EnumSceneFlags scene = EnumSceneFlags.ForceValidate)
    {
        if (IsFromPersistentSource && (scene & EnumSceneFlags.ForceValidate) == 0) return;
        var results = ValidateDataCore(scene).ToList();
        OnBusinessValidate(scene, results);
        if (results.Any()) throw new ValidationResultsException(results);
    }

    protected IEnumerable<ValidationResult> ValidateDataCore(EnumSceneFlags scene = EnumSceneFlags.None)
    {
        @{ await IncludeAsync("_InternalValidation.cshtml", Model); }
        yield break;
    }

    public bool IsFromPersistentSource { get; set; } = false;
    partial void OnBusinessValidate(EnumSceneFlags scene, List<ValidationResult> results);
}